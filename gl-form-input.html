
<!--<link rel="import" href="../paper-input/paper-input.html">-->
<link rel="import" href="../iron-input/iron-input.html">
<link rel="import" href="../iron-form-element-behavior/iron-form-element-behavior.html">
<link rel="import" href="../paper-input/paper-input-error.html">
<link rel="import" href="../paper-input/paper-input-behavior.html">
<link rel="import" href="../paper-input/paper-input-char-counter.html">
<link rel="import" href="../paper-input/paper-input-container.html">
<link rel="import" href="./../numeral-js/numeral-js.html">
<script src="./../numeral/min/numeral.min.js"></script>
<!--<link rel="import" href="../gl-font/gl-rsu-font.html">-->
<!--include="gl-rsu-font"-->
<dom-module id="gl-form-input">
    <style> 
      :host {
        display: block;
      }

      :host([focused]) {
        outline: none;
      }

      :host([hidden]) {
        display: none !important;
      }

      input::-webkit-input-placeholder {
        color: var(--paper-input-container-color, --secondary-text-color);
      }

      input:-moz-placeholder {
        color: var(--paper-input-container-color, --secondary-text-color);
      }

      input::-moz-placeholder {
        color: var(--paper-input-container-color, --secondary-text-color);
      }

      input:-ms-input-placeholder {
        color: var(--paper-input-container-color, --secondary-text-color);
      } 
      label{
        pointer-events: none;  
        font-family: 'rsuregular' !important;
        font-weight: bold !important;
        font-size: 22px !important;
      }
      input{
        /*font-family: 'rsuregular' !important;
        font-size: 18px !important;*/
      }
      numeral-js{
        position: absolute;
        font-size: 16px;
        top: 26px;
        right: 0%;
       
      }
       paper-input-container {
        --paper-input-container-disabled:{
            opacity: 1;
        }
        --paper-input-container-label:{
          color: var(--paper-input-label-color-success);
        }
        --paper-input-container-underline:{
          border-bottom: var(--paper-input-border-success);
        }
        --paper-input-container-underline-disabled:{
            display: none;
        }
      }
      .hide{
        display : var(--paper-input-show-number);
      }
    </style>
    <template>
   <paper-input-container no-label-float="[[noLabelFloat]]" always-float-label="[[_computeAlwaysFloatLabel(alwaysFloatLabel,placeholder)]]" auto-validate$="{{autoValidate}}" disabled$="[[disabled]]" invalid="[[invalid]]">
      
        <content select="[prefix]"></content>

        <label hidden$="[[!label]]" aria-hidden="true" for="input">[[label]]</label>

        <input is="iron-input" id="input"
            aria-labelledby$="[[_ariaLabelledBy]]"
            aria-describedby$="[[_ariaDescribedBy]]"
            disabled$="[[disabled]]"
            title$="[[title]]"
            bind-value="{{value}}"
            invalid="{{invalid}}"
            prevent-invalid-input="[[preventInvalidInput]]"
            allowed-pattern="[[allowedPattern]]"
            validator="[[validator]]"
            type$="[[type]]"
            pattern$="[[pattern]]"
            required$="[[required]]"
            autocomplete$="[[autocomplete]]"
            autofocus$="[[autofocus]]"
            inputmode$="[[inputmode]]"
            minlength$="[[minlength]]"
            maxlength$="[[maxlength]]"
            min$="[[min]]"
            max$="[[max]]"
            step$="[[step]]"
            name$="[[name]]"
            placeholder$="[[placeholder]]"
            readonly$="[[readonly]]"
            list$="[[list]]"
            size$="[[size]]"
            autocapitalize$="[[autocapitalize]]"
            autocorrect$="[[autocorrect]]"
            on-change="_onChange"
            tabindex$="[[tabindex]]"
            autosave$="[[autosave]]"
            results$="[[results]]"
            accept$="[[accept]]"
            multiple$="[[multiple]]" 
            on-blur="InputOnBlur" 
            on-focus="InputOnFocus"
            on-keyUp="_formatNumber"
            >
        <content select="[suffix]"></content>
        <template is="dom-if" if="[[errorMessage]]">
            <paper-input-error aria-live="assertive">[[errorMessage]]</paper-input-error>
        </template>
        
        <!--<div class="hide">
           <numeral-js number="{{dataFormatNumber}}" format="{{formatNumber}}" print></numeral-js>
        </div>-->
         
        
        <template is="dom-if" if="[[charCounter]]">
            <paper-input-char-counter></paper-input-char-counter>
        </template>

        </paper-input-container>
    </template>
    <script>
        Polymer({
            is: 'gl-form-input',
            behaviors : [
                Polymer.IronFormElementBehavior,
                Polymer.PaperInputBehavior
            ],
            // observers:['_disabledNumber()'],
            properties:{
                dataFormatNumber:{
                  type: String,
                  value: ''
                },
                formatNumber:{
                  observer: '_chkFormat'
                },
                setFormatNumber:{
                  type: String,
                  value: '0,0.00'
                },
                disabled:{
                  observer: '_chkdisabled'
                },
                statDisabled:{
                  type: Boolean,
                  value: false
                },
                statFormat:{
                  type: Boolean,
                  value: false
                }
            },
            ready:function(e){
              if(this.formatNumber)
                this.customStyle['--paper-input-show-number'] = "1";
              else
                this.customStyle['--paper-input-show-number'] = "none";
            },
            _chkdisabled:function(e){
              // console.log(e);
              this.statDisabled = e;
              this._disabledNumber();
            },
            _chkFormat:function(e){
              // console.log('_chkFormat',e);
              this.statFormat = e;
              this._disabledNumber();   
            },
            _disabledNumber:function(){
              if(this.statDisabled == true && typeof(this.statFormat) != 'undefined'){
                if(this.statFormat == ""){
                  this.statFormat = this.setFormatNumber;
                  // console.log(this.statFormat);
                }
                var value = this.$$('input').value;
                this.value = numeral(value).format(this.statFormat);
              }
            },
            _formatNumber:function(e){
              this.dataFormatNumber = e.target.value;
            },
            InputOnBlur : function(e){
              e.target.validate;
                if(e.target.validate()){
                    // console.log('Sucess!!');
                    this.customStyle['--paper-input-border-success'] =  "2px solid green";
                    this.customStyle['--paper-input-label-color-success'] = "green";
                }
                // if(this.formatNumber == ""){
                //   e.target.value = numeral(e.target.value).format(this.setFormatNumber);
                // }
                this.updateStyles();
            },
            _obformatNumber:function(number){
              return numeral(number).format(this.setFormatNumber);
            },
            InputOnFocus:function(e){
                // console.log('focus');
                this.customStyle['--paper-input-label-color-success'] = "#737373";
                // this.customStyle['--paper-input-container-color'] =  "#737373";
                this.updateStyles();
            },
            getValue:function(){
              // console.log(this.value);
              var data = numeral().unformat(this.value);
              return data;
            },
            reset:function(){
              //console.log(this.$$('input').required);
              // this.value="";
              if(this.required == true){
                this.$$('input').removeAttribute('required');
                this.$$('input').validate();
                this.$$('input').setAttribute("required", true);
              }
              this.customStyle['--paper-input-border-success'] =  "1px solid #737373";
              this.customStyle['--paper-input-label-color-success'] = "#737373";
              this.customStyle['--paper-input-container-color'] =  "#737373";
              this.updateStyles();
            }
            });
    </script>
</dom-module>
